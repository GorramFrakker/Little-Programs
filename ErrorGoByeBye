#ErrorGoByeBye
#This program takes a screenshot #whenever Microsoft Access errors
#out and emails it.

# Load the System.Drawing assembly
[Reflection.Assembly]::LoadWithPartialName("System.Drawing") | Out-Null

# Define the screenshot file path
$filePath = "C:\screenshots\error.png"

# Capture the screenshot
$bmp = New-Object System.Drawing.Bitmap(1000, 700)
$graphics = [System.Drawing.Graphics]::FromImage($bmp)
$graphics.CopyFromScreen(0,0,0,0, $bmp.Size)
$bmp.Save($filePath, [System.Drawing.Imaging.ImageFormat]::Png)

# Define the email properties
$from = "sender@example.com"
$to = "recipient@example.com"
$subject = "Error Screenshot"
$body = "Attached is a screenshot of the error that occurred."
$smtpServer = "smtp.example.com"
$port = 587

# Send the email with the attachment
Send-MailMessage -From $from -To $to -Subject $subject -Body $body -SmtpServer $smtpServer -Port $port -UseSsl -Credential (Get-Credential) -Attachments $filePath

#This script captures a #screenshot of the entire screen
#and sends it as an email #whenever it is run. To #integrate it with Windows Error
# Reporting, you'll need to #schedule the script to run #automatically using the Windows #Task Scheduler whenever an #error message appears.

#Note: You'll need to replace #the $from, $to, $smtpServer, #and other variables with the #appropriate values for your #email setup, and specify valid #login credentials for the email #account being used to send the #email.

#Windows Task Scheduler Creation.
#This will make thos all automatic.

